<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">

<html>
<head>
<title>Formula 2</title>

<link REL=STYLESHEET TYPE="text/css" HREF="seagate.css">

<!--
                 ***********************************
                 * Seagate Software copyright 1999 *
                 ***********************************

                      Template version: 5.1
-->


</head>

<body bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#0000FF" alink="#800080">


 
<a name="304424"></a><h3 class="newpage"> Formula 2</h3>
<a name="304425"></a><h4>Operators/Functions Used</h4><p><a name="304426"></a>If<nobr>-T</nobr>hen<nobr>-E</nobr>lse, Subscript [], Less Than (&lt;), Concatenate (+), Make range (to), ToNumber, Subtract (-), ToText, Parentheses ()</p><a name="304427"></a><h4>Formula Purpose</h4><p><a name="304428"></a>You have the date of first purchase coded as the fourth and fifth characters of the customer number (for example, 1971 as the 71 in ABC7101234, 1988 coded as the 88 in ABC880544, etc.) and you want to customize a letter to thank customers for the number of years they have done business with you. You want the following sentence to appear in your letter:</p><PRE><a name="304429"></a>"You have been a valued customer for" [x] "years."
<a name="304430"></a>&#171;Where x is the number of years.&#187;
</PRE><a name="304431"></a><h4>Formula</h4><PRE><a name="304432"></a>If {file.CUSTOMER NUMBER}[4 to 5] &lt; "90" Then
<a name="304433"></a>"You have been a valued customer for " + ToText(91
<a name="304434"></a>- ToNumber({file.CUSTOMER NUMBER}[4 to 5]))
<a name="304435"></a>+ " years."
<a name="304436"></a>Else 
<a name="304437"></a>"You are one of our newer customers, and we want you to 
know how valuable you are to us."
</PRE><a name="304438"></a><h4>Result</h4><p><a name="304456"></a> <Table Border="1">
<tr><td align="left" valign="TOP"><a name="304441"></a>Customer #

</td><td align="left" valign="TOP"><a name="304443"></a>Resulting Sentence

</td></tr>
<tr><td align="left" valign="TOP"><P><a name="304445"></a>ABC7801234</P>


</td><td align="left" valign="TOP"><P><a name="304447"></a>"You have been a valued customer for 13 years."</P>


</td></tr>
<tr><td align="left" valign="TOP"><P><a name="304449"></a>ABD890337</P>


</td><td align="left" valign="TOP"><P><a name="304451"></a>"You have been a valued customer for 2 years."</P>


</td></tr>
<tr><td align="left" valign="TOP"><P><a name="304453"></a>ABD904331</P>


</td><td align="left" valign="TOP"><P><a name="304455"></a>"You are one of our newer customers, and we want you to know how valuable you are to us."</P>


</td></tr>

</Table></p>
<a name="304457"></a><h4>Explanation</h4><ul type="disc"><a name="304458"></a><li>The If<nobr>-T</nobr>hen<nobr>-E</nobr>lse expression says, "If the 4th and 5th elements of the customer number, expressed as numbers, are less than 90, print a sentence including the date of first purchase, otherwise print the 'newer customer' sentence."
<a name="304459"></a><li>The formula above uses the Subscript [ ] operator to extract the 4th and 5th characters (your date code) from the customer numbers which are stored as text in character fields. The Make Range operator (to) is used to establish the range 4 to 5.
<a name="304460"></a><li>In the first example (ABC7801234) the 4th and 5th digits are 78 representing the year of first purchase as 1978.
<a name="304461"></a><li>In the second example (ABD8903337), the 4th and 5th digits are 89 representing the year of first purchase as 1989.
<a name="304462"></a><li>If the extracted characters are less than "90" (Then), a concatenated text string (a sentence) is printed that is customized to indicate the number of years the individual has been a customer. The text string says, "You have been a valued customer for (calculated number, expressed as text) years." 
<a name="304463"></a><li>The calculation of the number of years as a customer involves several steps:
<ul type="disc"><ul type="disc"><a name="304464"></a><li>_&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;As was done earlier, the Subscript [ ] operator extracts the 4th and 5th characters (your date code) from the customer numbers which are stored as text in character fields. The Make Range operator (to) is used to establish the range 4 to 5.<a name="304465"></a><li>_&nbsp;&nbsp;&nbsp;&nbsp;ToNumber converts the extracted date code to a number so it can be used in the calculation 91<nobr>-x</nobr>, where x = the date code expressed as a number.<a name="304466"></a><li>_&nbsp;&nbsp;&nbsp;&nbsp;91<nobr>-x</nobr> subtracts the year of first purchase from 91 (the current year) to get the number of years the individual has been a customer.<a name="304467"></a><li>_&nbsp;&nbsp;&nbsp;&nbsp;ToText then converts the result of that calculation back to text so it can be used in the expression "You have been a valued customer for (x) years." </ul></ul><a name="304468"></a><li>If the characters are "90" or more (Else), the fixed text string "You are one of our newer customers, and we want you to know how valuable you are to us" is printed.
<a name="304469"></a><li>The Parentheses () control the order of calculation of the formula.
</ul><a name="304470"></a><h6>Related topics</h6><p><a name="304474"></a><a href="19_introformulas30.html#287844">Formulas In Action</a></p>
<hr><br>

<script  language="JavaScript"><!--

var prev = "19_introformulas31.html";
var next = "19_introformulas33.html";

function setTopicID() { 
      var number = "304424"; 
      return number; 
}

// --></script>




<SCRIPT>

if (!window.parent.toc && navigator.appName == "Netscape") {

   document.writeln ('<TABLE ALIGN="left" border="0" cellspacing="0" cellpadding="10">');
   document.writeln ('<TR>');
   document.write ('<TD ALIGN="left">');

   if (prev != "crwTOC.hhc") {
      document.writeln ('<A HREF="' + prev + '">');
      document.writeln ('<IMG SRC="prevpage.gif" HEIGHT=17 BORDER=0 ALT="Previous page"></A>');
   } else {
//   window.alert ('no previous page');
   }

   if (next != "crwIX.hhk") {
      document.writeln ('<A HREF="' + next + '">');
      document.writeln ('<IMG SRC="nextpage.gif" HEIGHT=17 BORDER=0 ALT="Next page"></A>');
   } else {
//   window.alert ('no next page');
   }
   document.writeln ('</TD><TD ALIGN="left">');
   document.writeln ('<A HREF="frameset.htm?TOC">');
   document.writeln ('<IMG SRC="showtoc.gif" HEIGHT=17 BORDER=0 ALT="Click to show the Table of Contents"></A></TD>');
   document.writeln ('<TD ALIGN="left">');
   document.writeln ('<A HREF="frameset.htm?IDX">');
   document.writeln ('<IMG SRC="showix.gif" HEIGHT=17 BORDER=0 ALT="Click to show the Index"></A></TD>');
   document.writeln ('</TD>');
   document.writeln ('</TR>');
   document.writeln ('</TABLE>');

}

</SCRIPT>
<table align="right" border="0" cellspacing="0" cellpadding="0">
  <tr>
    <td align="right"><font size="1">Seagate Software, Inc.<br>
    <a href="http://www.seagatesoftware.com">http://www.seagatesoftware.com</a><br>
    Please send comments to:<br>
    <a href="mailto:techpubs@seagatesoftware.com">techpubs@seagatesoftware.com</a><br>
    </font></td>
  </tr>
</table>
</body>
</html>


